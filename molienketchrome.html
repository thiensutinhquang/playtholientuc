<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Đang chuyển hướng…</title>

  <!-- Preconnect để tối ưu tốc độ -->
  <link rel="preconnect" href="https://thiensutinhquang.github.io">

  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
      background: #f4f4f4;
      color: #333;
    }
    .card {
      background: #fff;
      padding: 25px;
      margin: auto;
      max-width: 360px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
    p { margin: 0.5rem 0; }
    button, a.link-btn {
      display: block;
      width: 100%;
      margin: 0.75rem 0;
      padding: 12px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      text-align: center;
    }
    button {
      background: #2a5db0;
      color: #fff;
    }
    a.link-btn {
      background: transparent;
      color: #2a5db0;
      text-decoration: underline;
    }
    #countdown { font-weight: bold; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="card">
    <h1>⏳ Đang chuyển hướng… (<span id="countdown">5</span>s)</h1>
    <p id="msg-normal">Nếu không tự động, bạn có thể:</p>
    <a id="manual-link" class="link-btn" href="https://thiensutinhquang.github.io/playtholientuc/" target="_blank" rel="noopener">
      Mở thủ công trong trình duyệt khác
    </a>
    <p id="msg-inapp" class="hidden">
      Bạn đang mở trong Facebook/Zalo/Messenger — bắt buộc nhấn nút dưới để mở bằng Chrome
    </p>
    <button id="btn-chrome">Mở bằng Chrome</button>
  </div>

  <script>
    (function() {
      const targetURL = 'https://thiensutinhquang.github.io/playtholientuc/';
      const ua = navigator.userAgent || '';
      const inFB   = ua.includes('FBAV') || ua.includes('FBAN');
      const inZalo = /Zalo/i.test(ua);
      const isInApp = inFB || inZalo;

      const countdownEl = document.getElementById('countdown');
      const msgNormal   = document.getElementById('msg-normal');
      const msgInApp    = document.getElementById('msg-inapp');
      const btnChrome   = document.getElementById('btn-chrome');

      // Tạo Intent URI cho Android
      function getAndroidIntent(u) {
        const url = new URL(u);
        return `intent://${url.host}${url.pathname}${url.search}#Intent;scheme=${url.protocol.replace(':','')};package=com.android.chrome;end`;
      }
      // Tạo scheme cho Chrome iOS
      function getiOSChrome(u) {
        return u.replace(/^https:\/\//, 'googlechromes://');
      }

      // Hàm mở Chrome
      function openInChrome() {
        let link;
        if (/Android/i.test(ua)) {
          link = getAndroidIntent(targetURL);
        } else if (/iPhone|iPad|iPod/i.test(ua)) {
          link = getiOSChrome(targetURL);
        }
        if (link) {
          window.location = link;
        } else {
          window.open(targetURL, '_blank');
        }
      }

      // Xử lý UI và hành vi
      if (isInApp) {
        // Ẩn countdown và nút mở thủ công, chỉ show nút Chrome
        countdownEl.parentElement.classList.add('hidden');
        msgNormal.classList.add('hidden');
        msgInApp.classList.remove('hidden');
      } else {
        // Bình thường: countdown auto-redirect
        let t = 5;
        const iv = setInterval(() => {
          t--;
          countdownEl.textContent = t;
          if (t <= 0) {
            clearInterval(iv);
            window.location.href = targetURL;
          }
        }, 1000);
      }

      // Gắn sự kiện nút Chrome
      btnChrome.addEventListener('click', openInChrome);
    })();
  </script>
</body>
</html>
